## TODO:
1. Развернуть сервис на Linux
2. Прописать pytesseract.pytesseract.tesseract_cmd для Linux
3. Поместить сервис в docker

## Nudity detection and word extraction from image.
На вход подается ссылка на изображение, далее:
1. Изображение скачивается и нормализуется
2. Классифицируется с помощью зафайнтюненой модели InceptionV3.
3. Если при классификации изображение не блокируется, то извлекается текст с помощью tesseract-ocr. 
4. Извлекается и проверяется текст на наличие мата. Если находит, то возвращает False.

Для работы нужно добавить папку с моделью. Скачать можно по ссылке: https://www.dropbox.com/sh/q9wo1gg6bsaau68/AAAB8FR7Ekrjnr7j-tTiqJ8ta?dl=0

## Модель:
1. После сравнения была выбрана предобученная модель InceptionV3, так как VGG16, ResNet показали меньшую точность и большее потребление памяти.
2. Модель была зафайнтюнена на 2.5к изображений каждого класса(Нетральный и Обнаженка)
3. Точность модели на тестовых данных: 92.6 процента. Confusion Matrix прикреплена ниже.
![Confusion Maztix](https://github.com/tskoxid/image-filter/blob/main/data/cm.JPG)
4. Модель потребляет 2.5 гб оперативной памяти.
5. Время инференса 1 изображения   --- 0.5912572383880615 seconds ---
6. Время инференса 15 изображений     --- 8.2843890190124512 seconds ---
